{% extends "base.html" %}
{% load leaflet_tags %}
{% load geojson_tags %}


{% block head %}
    {% leaflet_js %}
    {% leaflet_css %}
<style>
		body {
			padding: 0;
			margin: 0;
		}
        .leaflet-container {  /* all maps */
            width:  100%;
            height: 900px;
        }
	</style>
{% endblock %}

{% block body %}

    <div id="map"></div>
    <script type="text/javascript">


        {# var collection = [ {{ serialized|safe }} ]; #}
        var collection2 = [ {{ request.session.results|safe }} ];
      {#  {% for item in qs_results %}{{ item|geojsonfeature:"popupinfo"|safe }}{% endfor %}; #}


      function onEachFeature(feature, layer) {
    if (feature.properties && feature.properties.popupinfo) {
      layer.bindPopup(feature.properties.popupinfo, {maxHeight: 200 });
    }
  }
        options = {  center: [30.05,31.2333],
                      zoom: 3};
      //var options = {height: 180px;}
      function main_map_init(map, options) {
          L.geoJson(collection2,
                  {
                      onEachFeature: onEachFeature,
                      style: function(feature) {
        return {color: feature.properties.color}; },
                      pointToLayer: function(feature, latlng) {
        return new L.CircleMarker(latlng, {radius: 10, fillOpacity: 0.7});
    },
                  }).addTo(map);
          map.setView(new L.LatLng(13, 30),4);

      }



    </script>
        {% leaflet_map "main" callback="main_map_init" %}
{% endblock %}